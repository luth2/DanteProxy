# Dockerfile to create the Base Container for Dante Proxy with Alpine
# Build via Pipeline

FROM alpine:latest

LABEL org.opencontainers.image.authors="luth2"
LABEL org.opencontainers.image.description="Container with Dante Socks5 Proxy for Kubernetes"
LABEL org.opencontainers.image.source="https://github.com/luth2/DanteProxy"
LABEL org.opencontainers.image.version="1.0.0"
LABEL org.opencontainers.image.title="Dante Proxy Container"

ENV PORT=1080

# Install necessary packages
RUN apk update && apk add --no-cache \
    dante-server \
    openssl \
    && rm -rf /var/cache/apk/* /tmp/*

# Create a directory for Dante configuration
RUN mkdir -p /etc/dante

# Copy the Dante configuration file into the container
COPY Container/dante-bsp.conf /etc/dante/dante.conf

EXPOSE ${PORT}

# Set the entrypoint to the dante server executable with configuration path
ENTRYPOINT ["sockd", "-f", "/etc/dante/dante.conf", "-N"]
